<div class="tabs-content">
    <div class="userform">
        <form action="index.php?p=register" method="post" id="register" class="form">
            <? if(Session::checkErrors()){ ?>
            <div class="error">
                <?=$this->escape(Session::getErrorDescription())?>
            </div>
            <? } ?>

            <div class="form-row">
                <label for="username"><?=Lang::get('login_username')?></label>
                <input id="username" type="text" name="username" value="<?=$this->escape($username)?>" class="form-field" />
            </div>

            <div class="form-row">
                <label for="email">Email</label>
                <input id="email" type="text" name="email" value="<?=$this->escape($email)?>" class="form-field" />
            </div>

            <div class="form-row">
                <label for="password"><?=Lang::get('password')?></label>
                <input id="password" type="password" name="password" class="form-field" /><br/>
                                <small><?=Lang::get('password_desc')?></small>
            </div>

            <?
            if(CMS::IsFeatureEnabled('ReferralProgram')){
                print ReferalSystem::onRegisterFormRender();
            }
            ?>

            <?=Plugins::invokeEvent('onRegisterFormRender')?>

            <? if (empty($hideCaptcha)) { ?>
            <div class="form-row">
                <label>&nbsp;</label>
                <span class="input captcha">
                    <img id="siimage" style="border: 1px solid #000; margin-right: 15px" src="./lib/securimage/securimage_show.php?sid=<?php echo md5(uniqid()) ?>" alt="CAPTCHA Image" align="left">
                    <object type="application/x-shockwave-flash" data="./lib/securimage/securimage_play.swf?audio_file=./lib/securimage/securimage_play.php&amp;bgColor1=#fff&amp;bgColor2=#fff&amp;iconColor=#777&amp;borderWidth=1&amp;borderColor=#000" height="32" width="32">
                    <param name="movie" value="./lib/securimage/securimage_play.swf?audio_file=./lib/securimage/securimage_play.php&amp;bgColor1=#fff&amp;bgColor2=#fff&amp;iconColor=#777&amp;borderWidth=1&amp;borderColor=#000">
                    </object>
                    &nbsp;
                    <a tabindex="-1" style="border-style: none;" href="#" title="Refresh Image" onclick="document.getElementById('siimage').src = './lib/securimage/securimage_show.php?sid=' + Math.random(); this.blur(); return false"><img src="./lib/securimage/images/refresh.png" alt="Reload Image" onclick="this.blur()" align="bottom" border="0"></a><br />
                    <?=Lang::get('input_captcha')?>:<br />
                    <?php echo @$_SESSION['ctform']['captcha_error'] ?>
                    <input type="text" name="ct_captcha" class="captchainp form-field" size="12" maxlength="8" id="captcha" />
                </span>
            </div>
            <? } ?>
            <div class="form-row">
                <label>&nbsp;</label>
                <label for="agree" class="agree">
                    <input id="agree" type="checkbox" class="checkbox" name="agree" value="agree" <?=$agree?> />
                </label>

                    <?=Lang::get('agree_with')?> <a id="user_agreement_spoiler-toggler"><?=Lang::get('user_agreement')?></a>
            </div>
            <div style="display: none" id="user_agreement_spoiler-text" class="user_agreement_spoiler-text">
                <?=$userAgreement?>
            </div>


            <script>
                $('#user_agreement_spoiler-toggler').click(function(){
                   $('#user_agreement_spoiler-text').slideToggle('400');
                });
            </script>

            <div class="form-row register">
                <label>&nbsp;</label>
                <input type="submit" id="submitb" name="login" value="<?=Lang::get('registration_label')?>"class="btn_office" />
            </div>
        </form>
    </div>
</div>
<!--noindex-->
<script type="text/javascript">
$(function()
{
    function checkregister()
    {
        var f = true;
        if ($('#username').val() == '') f = false;
        if ($('#email').val() == '') f = false;
        if ($('#password').val() == '') f = false;
        if ($('#captcha').val() == '') f = false;
        if ($('#agree').attr('checked') != 'checked') f = false;
        if (!f) {
            $('#submitb').attr('disabled', 'disabled');
            $('#submitb').addClass('btn_office_disabled');
        } else {
            $('#submitb').removeAttr('disabled');
            $('#submitb').removeClass('btn_office_disabled');
        }
    }
    $('#username, #email, #password, #captcha').keyup(function () {
        checkregister();
    });
    $('#agree').change(function () {
        checkregister();
    });
    checkregister();
});
</script>
<!--/noindex-->
