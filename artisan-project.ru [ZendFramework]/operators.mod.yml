tables:
  operators:
    fields:
      id: {type: int, notnull: 1, unsigned: 1, auto_increment: 1, am: {title: ID}}
      cdate: {type: datetime, am: {type: datetime, title: Дата создания оператора}}
      mdate: {type: datetime, am: {type: datetime, title: Дата редактирования оператора}}
      login: {type: varchar, length: 32, notnull: 1, am: {type: login, req: 1, title: Логин}}
      pass: {type: varchar, length: 32, notnull: 1, am: {type: pass, req: 1, htmltype: pass, title: Пароль}}
      blocked: {type: enum('yes','no'), default: 'no', notnull: 1, am: {type: string, title: Доступ к системе, otitle: Запретить, htmltype: checkbox, default: 'no', checked: 'yes', values: {no: доступ разрешен, yes: доступ запрещен}}}
      deleted: {type: enum('yes','no'), default: 'no', notnull: 1, am: {type: string, title: Удалить, otitle: Удалить, htmltype: checkbox, default: 'no', checked: 'yes', values: {no: доступ разрешен, yes: Удален}}}
      name: {type: tinytext, notnull: 1, am: {type: string, title: Имя}}
      rights: {type: "enum('requests','shipments')", default: 'requests', am: {type: select, title: Права, values: {requests: Заявки, shipments: Отгрузки}}}
      categories:
        virtual: 1
        ref_to:
          idFieldName: id
          virtual: 1
          table: ?_dealers_categories
          fields: [id, title]
          use_ref: operators2dealers_categories
        am: {type: checkboxes, br: ' ', del: ' ', key: id, title: Категории дилеров}
    table:
      PRIMARY KEY: id
      KEYS:
        credentials: [login, pass, blocked, deleted]
    actions:
      list: [id, login, name, blocked, categories, rights]
      show: [cdate, mdate, name, login, pass, blocked, rights]
      add: [login, pass, name, blocked, categories, rights]
      modify: [name, blocked, categories, rights]
      change_pass: [pass]
      login: [login, pass]
      profile: [name, login]
      edit-profile: [name]

  operators2categories:
    fields:
      operator_id: {type: int, notnull: 1, unsigned: 1}
      dealer_category_id: {type: int, notnull: 1, unsigned: 1}

  dealers_categories:
    dont_install: 1
    fields:
      id: {type: int, notnull: 1, unsigned: 1, auto_increment: 1}
      title: {type: tinytext, notnull: 1, am: {type: string, title: Наименование}}
    table:
      PRIMARY KEY: id
    actions:
      list: [id, title]
      show: [title]
      add: [title]
      modify: [title]

refs:
  operators2dealers_categories:
    virtual: 1
    join: left outer
    type: N-M
    tables:
      -
        - {table: operators, field: id}
        - {table: operators2categories, field: operator_id}
      -
        - {table: dealers_categories, field: id}
        - {table: operators2categories, field: dealer_category_id}